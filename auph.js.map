{"version":3,"file":"auph.js","sources":["../module/impl/debug.js","../module/impl/Device.js","../module/impl/StreamPlayer.js","../module/impl/Voice.js","../module/impl/AudioData.js","../module/impl/Bus.js","../module/index.js","../module/sa.js"],"sourcesContent":["var TAG = \"[AUPH]\";\nexport function log(message) {\n    if (process.env.NODE_ENV !== \"production\") {\n        console.log(TAG, message);\n    }\n}\nexport function warn(message) {\n    console.warn(TAG, message);\n}\nexport function error(message, reason) {\n    console.error(TAG, message, reason);\n}\nexport function measure(ts) {\n    if (ts === void 0) { ts = 0; }\n    if (process.env.NODE_ENV !== \"production\") {\n        return performance.now() - ts;\n    }\n    else {\n        return 0;\n    }\n}\n//# sourceMappingURL=debug.js.map","import { error, log, warn } from \"./debug\";\nvar ctx = null;\nvar unlockEvents = [\"mousedown\", \"pointerdown\", \"touchstart\"];\nvar unlocked = false;\nexport function getContext() {\n    if (!ctx) {\n        warn(\"not initialized\");\n        return null;\n    }\n    if (ctx.state === \"closed\") {\n        error(\"invalid state:\", \"Context is closed\");\n        return null;\n    }\n    return ctx;\n}\nexport function getContextState() {\n    var state = 0 /* Invalid */;\n    if (ctx) {\n        if (ctx.state === \"suspended\") {\n            state = 2 /* Paused */;\n        }\n        else if (ctx.state === \"running\") {\n            state = 1 /* Running */;\n        }\n    }\n    return state;\n}\nexport function resumeAudioContext(ctx) {\n    log(\"resuming...\");\n    ctx.resume().then(function () {\n        log(\"resumed\");\n    }).catch(function (reason) {\n        if (!unlocked) {\n            log(\"cannot resume until user interaction, setup unlock handler...\");\n            setupUnlockHandler();\n        }\n        else {\n            error(\"error resuming AudioContext\", reason);\n        }\n    });\n}\nexport function suspendAudioContext(ctx) {\n    log(\"AudioContext suspending...\");\n    ctx.suspend().then(function () {\n        log(\"AudioContext suspended\");\n    }).catch(function (reason) {\n        error(\"error suspending AudioContext\", reason);\n    });\n}\nfunction unlock() {\n    unlocked = true;\n    var removeEventListener = document.removeEventListener;\n    for (var i = 0; i < unlockEvents.length; ++i) {\n        removeEventListener(unlockEvents[i], unlock);\n    }\n    if (ctx && ctx.state === \"suspended\") {\n        resumeAudioContext(ctx);\n    }\n}\nfunction setupUnlockHandler() {\n    var addEventListener = document.addEventListener;\n    for (var i = 0; i < unlockEvents.length; ++i) {\n        addEventListener(unlockEvents[i], unlock);\n    }\n}\nexport function initContext() {\n    if (ctx) {\n        warn(\"already initialized\");\n        return ctx;\n    }\n    ctx = new AudioContext({\n        latencyHint: \"interactive\",\n        sampleRate: 22050\n    });\n    if (!ctx) {\n        error(\"error create AudioContext\");\n        return null;\n    }\n    if (ctx.state === \"running\") {\n        suspendAudioContext(ctx);\n    }\n    log(\"Latency: \" + ctx.baseLatency);\n    log(\"Sample rate: \" + ctx.sampleRate);\n    return ctx;\n}\nexport function closeContext(_notNullCtx) {\n    log(\"shutdown...\");\n    _notNullCtx.close().then(function () {\n        log(\"shutdown completed\");\n    }).catch(function (reason) {\n        error(\"shutdown error\", reason);\n    });\n    ctx = null;\n}\n//# sourceMappingURL=Device.js.map","import { getContext } from \"./Device\";\nimport { error, log } from \"./debug\";\nvar emptyWaveData = \"data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEAVFYAAFRWAAABAAgAZGF0YQAAAAA=\";\nvar StreamPlayer = /** @class */ (function () {\n    function StreamPlayer(el, node) {\n        this.el = el;\n        this.node = node;\n    }\n    return StreamPlayer;\n}());\nexport { StreamPlayer };\nexport function StreamPlayer_create(ctx, url) {\n    var el = new Audio(url);\n    el.preload = \"metadata\";\n    el[\"preservesPitch\"] = false;\n    return new StreamPlayer(el, ctx.createMediaElementSource(el));\n}\nexport function StreamPlayer_isFree(player) {\n    return player.el.src === emptyWaveData;\n}\nexport function StreamPlayer_stop(player) {\n    var el = player.el;\n    if (el.src !== emptyWaveData) {\n        el.pause();\n        el.src = emptyWaveData;\n        el.currentTime = 0;\n        player.node.disconnect();\n    }\n}\nexport function StreamPlayer_resume(player) {\n    player.el.play().then(function () {\n        log(\"started stream player\");\n    }).catch(function (reason) {\n        error(\"error on play stream\", reason);\n    });\n}\nvar players = [];\nvar playersMaxCount = 4;\nexport function getNextStreamPlayer(src) {\n    for (var i = 0; i < players.length; ++i) {\n        var player = players[i];\n        if (StreamPlayer_isFree(player)) {\n            player.el.src = src;\n            return player;\n        }\n    }\n    if (players.length < playersMaxCount) {\n        var ctx = getContext();\n        if (ctx) {\n            var mes = StreamPlayer_create(ctx, src);\n            players.push(mes);\n            return mes;\n        }\n    }\n    return null;\n}\nexport function destroyStreamPlayersPool() {\n    for (var i = 0; i < players.length; ++i) {\n        var player = players[i];\n        StreamPlayer_stop(player);\n        player.el.src = \"\";\n    }\n    players.length = 0;\n}\nexport function getStreamPlayersCount() {\n    var count = 0;\n    for (var i = 0; i < players.length; ++i) {\n        if (!StreamPlayer_isFree(players[i])) {\n            ++count;\n        }\n    }\n    return count;\n}\n//# sourceMappingURL=StreamPlayer.js.map","import { StreamPlayer_resume, StreamPlayer_stop } from \"./StreamPlayer\";\nimport { getContext } from \"./Device\";\nvar vMask = 0xFFFF00;\nvar vIncr = 0x000100;\nvar iMask = 0x0000FF;\nvar VoiceObj = /** @class */ (function () {\n    function VoiceObj(gain, pan) {\n        var _this = this;\n        this.gain = gain;\n        this.pan = pan;\n        this.stream = null;\n        // buffer playback\n        this.buffer = null;\n        // common nodes\n        // \"Pitch\" / \"Playback Rate\"\n        this.rate = 1.0;\n        // Control Flags\n        this.cf = 0;\n        this.target = null;\n        this.data = 0;\n        // handle version (maybe will add index as well)\n        this.v = 0;\n        this._e = function (e) {\n            // maybe check is useless\n            if (_this.buffer === e.target) {\n                Voice_stop(_this);\n            }\n        };\n    }\n    return VoiceObj;\n}());\nexport { VoiceObj };\nexport function Voice_create(ctx) {\n    var gain = ctx.createGain();\n    var pan = ctx.createStereoPanner();\n    pan.connect(gain);\n    return new VoiceObj(gain, pan);\n}\nexport function Voice_changeDestination(v, target) {\n    if (target !== v.target) {\n        var gain = v.gain;\n        if (v.target) {\n            gain.disconnect(v.target);\n        }\n        v.target = target;\n        if (target) {\n            gain.connect(target);\n        }\n    }\n}\nexport function Voice_resetDestination(v) {\n    if (v.target) {\n        v.gain.disconnect(v.target);\n        v.target = null;\n    }\n}\nexport function Voice_stop(v) {\n    // stop stream\n    if (v.stream) {\n        StreamPlayer_stop(v.stream);\n        v.stream = null;\n    }\n    // stop buffer\n    var buffer = v.buffer;\n    if (buffer) {\n        if ((v.cf & 1 /* Running */) !== 0) {\n            buffer.stop();\n        }\n        buffer.disconnect();\n        v.buffer = null;\n    }\n    Voice_resetDestination(v);\n    v.data = 0;\n    v.cf = 0;\n    v.v = (v.v + vIncr) & vMask;\n}\nexport function Voice_startBuffer(v) {\n    if ((v.cf & 1 /* Running */) === 0) {\n        var source = v.buffer;\n        if (source) {\n            //source.addEventListener(\"ended\", v._e, {once: true});\n            source.onended = v._e;\n            source.loop = (v.cf & 4 /* Loop */) !== 0;\n            source.start();\n            v.cf |= 1 /* Running */;\n        }\n    }\n}\nexport function Voice_prepareBuffer(v, ctx, audioBuffer) {\n    var source = ctx.createBufferSource();\n    source.buffer = audioBuffer;\n    source.connect(v.pan);\n    v.buffer = source;\n}\nexport function Voice_loop(v, value) {\n    var current = (v.cf & 4 /* Loop */) !== 0;\n    if (value !== current) {\n        v.cf ^= 4 /* Loop */;\n        if (v.stream) {\n            v.stream.el.loop = value;\n        }\n        else if (v.buffer) {\n            v.buffer.loop = value;\n        }\n    }\n}\nexport function Voice_pause(v, value) {\n    var paused = (v.cf & 2 /* Paused */) !== 0;\n    if (value !== paused) {\n        v.cf ^= 2 /* Paused */;\n        if (value) {\n            if (v.stream) {\n                v.stream.el.pause();\n            }\n            else if (v.buffer) {\n                v.buffer.playbackRate.value = 0.0;\n            }\n        }\n        else {\n            if (v.stream) {\n                StreamPlayer_resume(v.stream);\n            }\n            else if (v.buffer) {\n                v.buffer.playbackRate.value = v.rate;\n                // restart if play called in pause mode\n                Voice_startBuffer(v);\n            }\n        }\n    }\n}\nexport function Voice_pitch(v, value) {\n    if (v.rate !== value) {\n        v.rate = value;\n        if (v.stream) {\n            v.stream.el.playbackRate = value;\n        }\n        else if (v.buffer) {\n            if (!(v.cf & 2 /* Paused */)) {\n                v.buffer.playbackRate.value = value;\n            }\n        }\n    }\n}\nexport var voicePool = [null];\nvar voicesMaxCount = 64;\nexport function _checkVoiceHandle(handle) {\n    var obj = voicePool[handle & iMask];\n    return !!obj && obj.v === (handle & vMask);\n}\nexport function _getVoiceObjAt(index) {\n    return voicePool[index];\n}\nexport function _getVoiceObj(handle) {\n    var obj = voicePool[handle & iMask];\n    return (obj && obj.v === (handle & vMask)) ? obj : null;\n}\nexport function getNextVoice() {\n    for (var i = 1; i < voicePool.length; ++i) {\n        var v = voicePool[i];\n        if (v.data === 0) {\n            return i | v.v;\n        }\n    }\n    var index = voicePool.length;\n    if (index < voicesMaxCount) {\n        var ctx = getContext();\n        if (ctx) {\n            voicePool.push(Voice_create(ctx));\n            return index;\n        }\n    }\n    return 0;\n}\n//# sourceMappingURL=Voice.js.map","var AudioDataObj = /** @class */ (function () {\n    function AudioDataObj() {\n        this.cf = 0 /* Invalid */;\n        this.data = null;\n    }\n    return AudioDataObj;\n}());\nexport { AudioDataObj };\nexport var audioDataPool = [null];\nvar audioDataMaxCount = 128;\nexport function getNextAudioData() {\n    for (var i = 1; i < audioDataPool.length; ++i) {\n        if (audioDataPool[i].cf === 0) {\n            return i;\n        }\n    }\n    var next = audioDataPool.length;\n    if (next < audioDataMaxCount) {\n        audioDataPool.push(new AudioDataObj());\n        return next;\n    }\n    return 0;\n}\n//# sourceMappingURL=AudioData.js.map","import { getContext } from \"./Device\";\nvar BusObj = /** @class */ (function () {\n    function BusObj(gain, e) {\n        if (e === void 0) { e = true; }\n        this.gain = gain;\n        this.e = e;\n    }\n    return BusObj;\n}());\nexport { BusObj };\nvar busPool = [];\nexport function Bus_create(ctx) {\n    var obj = new BusObj(ctx.createGain());\n    busPool.push(obj);\n    return obj;\n}\nexport function initBusPool(ctx) {\n    var master = Bus_create(ctx).gain;\n    master.connect(ctx.destination);\n    Bus_create(ctx).gain.connect(master);\n    Bus_create(ctx).gain.connect(master);\n    Bus_create(ctx).gain.connect(master);\n}\nexport function termBusPool() {\n    for (var i = 0; i < busPool.length; ++i) {\n        busPool[i].gain.disconnect();\n    }\n    busPool.length = 0;\n}\nexport function _getBus(handle) {\n    return busPool[handle];\n}\nexport function _getBusGain(handle) {\n    var obj = _getBus(handle);\n    return obj ? obj.gain : undefined;\n}\nexport function Bus_enable(bus, enabled) {\n    if (bus.e !== enabled) {\n        var master = busPool[0];\n        var dest = bus === master ? getContext().destination : master.gain;\n        if (enabled) {\n            bus.gain.connect(dest);\n        }\n        else {\n            bus.gain.disconnect(dest);\n        }\n        bus.e = enabled;\n    }\n}\n//# sourceMappingURL=Bus.js.map","import { destroyStreamPlayersPool, getNextStreamPlayer, getStreamPlayersCount, StreamPlayer_resume } from \"./impl/StreamPlayer\";\nimport { closeContext, getContext, getContextState, initContext, resumeAudioContext } from \"./impl/Device\";\nimport { _checkVoiceHandle, _getVoiceObj, getNextVoice, Voice_changeDestination, Voice_loop, Voice_pause, Voice_pitch, Voice_prepareBuffer, Voice_startBuffer, Voice_stop, voicePool } from \"./impl/Voice\";\nimport { audioDataPool, getNextAudioData } from \"./impl/AudioData\";\nimport { _getBus, _getBusGain, Bus_enable, initBusPool, termBusPool } from \"./impl/Bus\";\nimport { error, log, measure, warn } from \"./impl/debug\";\nexport function init() {\n    var ctx = initContext();\n    if (ctx) {\n        initBusPool(ctx);\n    }\n}\nexport function resume() {\n    var ctx = getContext();\n    if (ctx && ctx.state === \"suspended\") {\n        resumeAudioContext(ctx);\n    }\n}\nexport function pause() {\n    var ctx = getContext();\n    if (ctx && ctx.state === \"running\") {\n        log(\"pausing\");\n        ctx.suspend().then(function () {\n            log(\"paused\");\n        }).catch(function (reason) {\n            error(\"pause error\", reason);\n        });\n    }\n}\nexport function shutdown() {\n    var ctx = getContext();\n    if (ctx) {\n        termBusPool();\n        voicePool.length = 1;\n        audioDataPool.length = 1;\n        destroyStreamPlayersPool();\n        closeContext(ctx);\n    }\n}\n/*** Context State ***/\nexport function getInteger(param) {\n    switch (param) {\n        case 0 /* VoicesInUse */: {\n            var count = 0;\n            for (var i = 1; i < voicePool.length; ++i) {\n                if (voicePool[i].buffer) {\n                    ++count;\n                }\n            }\n            return count;\n        }\n        case 1 /* StreamsInUse */: {\n            return getStreamPlayersCount();\n        }\n        case 2 /* BuffersLoaded */: {\n            return 0;\n        }\n        case 3 /* StreamsLoaded */: {\n            return 0;\n        }\n        case 4 /* Device_SampleRate */: {\n            var ctx = getContext();\n            return ctx ? ctx.sampleRate : 0;\n        }\n        case 5 /* Device_State */: {\n            return getContextState();\n        }\n    }\n    return 0;\n}\n/**\n * private function to get native HTMl5 AudioContext\n */\nexport function _getAudioContext() {\n    return getContext();\n}\n// TODO: move\nfunction fetchURL(filepath, cb) {\n    return fetch(new Request(filepath)).then(cb);\n}\n/***/\nexport function load(filepath, streaming) {\n    var handle = getNextAudioData();\n    if (handle === 0) {\n        return 0;\n    }\n    var obj = audioDataPool[handle];\n    obj.cf |= 1 /* Empty */;\n    if (streaming) {\n        obj.cf |= 4 /* Stream */;\n        fetchURL(filepath, function (response) { return response.blob(); }).then(function (blob) {\n            obj.data = URL.createObjectURL(blob);\n            obj.cf |= 2 /* Loaded */;\n        }).catch(function (reason) {\n            error(\"can't load audio stream data \" + filepath, reason);\n        });\n    }\n    else {\n        var timeDecoding_1 = 0;\n        fetchURL(filepath, function (response) { return response.arrayBuffer(); }).then(function (buffer) {\n            var ctx = getContext();\n            if (ctx) {\n                timeDecoding_1 = measure();\n                return ctx.decodeAudioData(buffer);\n            }\n            return null;\n        }).then(function (buffer) {\n            obj.data = buffer;\n            if (buffer) {\n                log(\"decoding time: \" + (measure(timeDecoding_1) | 0) + \" ms.\");\n                obj.cf |= 2 /* Loaded */;\n            }\n        }).catch(function (reason) {\n            error(\"can't load audio buffer from \" + filepath, reason);\n        });\n    }\n    return handle;\n}\nexport function unload(data) {\n    if (data === 0) {\n        return;\n    }\n    stopAudioData(data);\n    var sourceObj = audioDataPool[data];\n    if (sourceObj) {\n        if ((sourceObj.cf & 4 /* Stream */) !== 0 && sourceObj.data) {\n            URL.revokeObjectURL(sourceObj.data);\n        }\n        sourceObj.cf = 0;\n        sourceObj.data = null;\n    }\n}\n/***\n *\n * @param data\n * @param volume\n * @param pan\n * @param pitch\n * @param paused\n * @param loop\n * @param bus\n */\nexport function play(data, volume, pan, pitch, paused, loop, bus) {\n    if (volume === void 0) { volume = 1.0; }\n    if (pan === void 0) { pan = 0.0; }\n    if (pitch === void 0) { pitch = 1.0; }\n    if (paused === void 0) { paused = false; }\n    if (loop === void 0) { loop = false; }\n    if (bus === void 0) { bus = 1; }\n    if (data === 0) {\n        return 0;\n    }\n    var ctx = getContext();\n    if (!ctx) {\n        return 0;\n    }\n    var dataObj = audioDataPool[data];\n    if (!dataObj) {\n        warn(\"audio source not found\");\n        return 0;\n    }\n    if ((dataObj.cf & 2 /* Loaded */) === 0) {\n        warn(\"audio source is not loaded yet\");\n        return 0;\n    }\n    if (dataObj.data === null) {\n        warn(\"nothing to play, no audio data\");\n        return 0;\n    }\n    var targetNode = _getBusGain(bus);\n    if (!targetNode) {\n        warn(\"invalid target bus!\");\n        return 0;\n    }\n    var voice = getNextVoice();\n    if (!voice) {\n        log(\"no more free simple voices!\");\n        return 0;\n    }\n    var voiceObj = _getVoiceObj(voice);\n    if (loop) {\n        voiceObj.cf |= 4 /* Loop */;\n    }\n    if (paused) {\n        voiceObj.cf |= 2 /* Paused */;\n    }\n    voiceObj.rate = 1.0;\n    voiceObj.data = data;\n    voiceObj.gain.gain.value = volume;\n    voiceObj.pan.pan.value = pan;\n    if (dataObj.cf & 4 /* Stream */) {\n        var mes = getNextStreamPlayer(dataObj.data);\n        if (!mes) {\n            log(\"no more free media stream elements!\");\n            return 0;\n        }\n        voiceObj.stream = mes;\n        mes.el.loop = loop;\n        mes.node.connect(voiceObj.pan);\n        if (!paused) {\n            StreamPlayer_resume(mes);\n            voiceObj.cf |= 1 /* Running */;\n        }\n    }\n    else {\n        Voice_prepareBuffer(voiceObj, ctx, dataObj.data);\n        if (!paused) {\n            Voice_startBuffer(voiceObj);\n        }\n    }\n    // maybe we need to set target before `startBuffer()`\n    Voice_changeDestination(voiceObj, targetNode);\n    Voice_pitch(voiceObj, pitch);\n    return voice;\n}\nexport function stop(voice) {\n    var obj = _getVoiceObj(voice);\n    if (obj) {\n        Voice_stop(obj);\n    }\n}\nexport function isVoiceValid(voice) {\n    return _checkVoiceHandle(voice);\n}\nexport function getVoiceState(voice) {\n    var obj = _getVoiceObj(voice);\n    return obj ? obj.cf : 0;\n}\nexport function setPan(voice, value) {\n    var obj = _getVoiceObj(voice);\n    if (obj) {\n        obj.pan.pan.value = value;\n    }\n}\nexport function setVolume(voice, value) {\n    var obj = _getVoiceObj(voice);\n    if (obj) {\n        obj.gain.gain.value = value;\n    }\n}\nexport function setPitch(voice, value) {\n    var obj = _getVoiceObj(voice);\n    if (obj) {\n        Voice_pitch(obj, value);\n    }\n}\nexport function setPause(voice, value) {\n    var obj = _getVoiceObj(voice);\n    if (obj) {\n        Voice_pause(obj, value);\n    }\n}\nexport function setLoop(voice, value) {\n    var obj = _getVoiceObj(voice);\n    if (obj) {\n        Voice_loop(obj, value);\n    }\n}\nexport function getPan(voice) {\n    var obj = _getVoiceObj(voice);\n    return obj ? obj.pan.pan.value : 0.0;\n}\nexport function getVolume(voice) {\n    var obj = _getVoiceObj(voice);\n    return obj ? obj.gain.gain.value : 1.0;\n}\nexport function getPitch(voice) {\n    var obj = _getVoiceObj(voice);\n    return obj ? obj.rate : 1.0;\n}\nexport function getPause(voice) {\n    var obj = _getVoiceObj(voice);\n    return !!obj && (obj.cf & 2 /* Paused */) !== 0;\n}\nexport function getLoop(voice) {\n    var obj = _getVoiceObj(voice);\n    return !!obj && (obj.cf & 4 /* Loop */) !== 0;\n}\nexport function stopAudioData(data) {\n    if (data === 0) {\n        console.warn(\"invalid source\");\n        return;\n    }\n    for (var i = 1; i < voicePool.length; ++i) {\n        var v = voicePool[i];\n        if (v.data === data) {\n            Voice_stop(v);\n        }\n    }\n}\n/** Bus controls **/\nexport function setBusVolume(bus, value) {\n    var gain = _getBusGain(bus);\n    if (gain) {\n        gain.gain.value = value;\n    }\n}\nexport function getBusVolume(bus) {\n    var gain = _getBusGain(bus);\n    return gain ? gain.gain.value : 0.0;\n}\nexport function setBusEnabled(bus, enabled) {\n    var obj = _getBus(bus);\n    if (obj) {\n        Bus_enable(obj, enabled);\n    }\n}\nexport function getBusEnabled(bus) {\n    var obj = _getBus(bus);\n    return !!obj && obj.e;\n}\n/** length / position **/\nexport function getAudioDataState(data) {\n    if (data !== 0) {\n        var obj = audioDataPool[data];\n        if (obj) {\n            return obj.cf;\n        }\n    }\n    return 0 /* Invalid */;\n}\nexport function getAudioSourceLength(data) {\n    var d = 0.0;\n    if (data !== 0) {\n        var obj = audioDataPool[data];\n        if (obj && obj.data) {\n            if (obj.cf & 4 /* Stream */) {\n                // TODO: :(\n            }\n            else {\n                d = obj.data.duration;\n            }\n        }\n    }\n    return d;\n}\nexport function getVoiceLength(voice) {\n    var obj = _getVoiceObj(voice);\n    var d = 0.0;\n    if (obj) {\n        if (obj.buffer && obj.buffer.buffer) {\n            d = obj.buffer.buffer.duration;\n        }\n        else if (obj.stream) {\n            d = obj.stream.el.duration;\n        }\n    }\n    return d;\n}\nexport function getVoicePosition(voice) {\n    var obj = _getVoiceObj(voice);\n    var d = 0.0;\n    if (obj) {\n        if (obj.buffer && obj.buffer) {\n            // TODO: :(\n        }\n        else if (obj.stream) {\n            d = obj.stream.el.currentTime;\n        }\n    }\n    return d;\n}\n//# sourceMappingURL=index.js.map","/** Export Constants only for pre-bundled usage **/\nexport var VOICES_IN_USE = 0 /* VoicesInUse */;\nexport var STREAMS_IN_USE = 1 /* StreamsInUse */;\nexport var BUFFERS_LOADED = 2 /* BuffersLoaded */;\nexport var STREAMS_LOADED = 3 /* StreamsLoaded */;\nexport var DEVICE_SAMPLE_RATE = 4 /* Device_SampleRate */;\nexport var DEVICE_STATE = 5 /* Device_State */;\nexport var BUS_MASTER = 0;\nexport var BUS_SFX = 1;\nexport var BUS_MUSIC = 2;\nexport var BUS_SPEECH = 2;\nexport function getDeviceStateString(state) {\n    var _a;\n    return (_a = [\"invalid\", \"running\", \"paused\"][state]) !== null && _a !== void 0 ? _a : \"undefined\";\n}\nexport function getAudioDataStateString(state) {\n    var _a;\n    return (_a = [\"invalid\", \"loading\", \"-\", \"loaded\"][state & 0x3]) !== null && _a !== void 0 ? _a : \"undefined\";\n}\nexport * from \"./index\";\n//# sourceMappingURL=sa.js.map"],"names":["TAG","warn","message","console","error","reason","ctx","unlockEvents","unlocked","getContext","state","getContextState","resumeAudioContext","resume","then","catch","addEventListener","document","i","length","unlock","setupUnlockHandler","removeEventListener","initContext","AudioContext","latencyHint","sampleRate","suspend","suspendAudioContext","baseLatency","closeContext","_notNullCtx","close","emptyWaveData","StreamPlayer","el","node","this","StreamPlayer_isFree","player","src","StreamPlayer_stop","pause","currentTime","disconnect","StreamPlayer_resume","play","players","getNextStreamPlayer","mes","url","Audio","preload","createMediaElementSource","StreamPlayer_create","push","vMask","VoiceObj","gain","pan","_this","stream","buffer","rate","cf","target","data","v","_e","e","Voice_stop","stop","Voice_resetDestination","Voice_startBuffer","source","onended","loop","start","Voice_pitch","value","playbackRate","voicePool","_getVoiceObj","handle","obj","getNextVoice","index","createGain","createStereoPanner","connect","Voice_create","AudioDataObj","audioDataPool","BusObj","busPool","Bus_create","_getBus","_getBusGain","undefined","fetchURL","filepath","cb","fetch","Request","stopAudioData","_a","d","duration","bus","param","count","getStreamPlayersCount","voice","master","destination","initBusPool","streaming","next","getNextAudioData","response","blob","URL","createObjectURL","arrayBuffer","decodeAudioData","volume","pitch","paused","dataObj","targetNode","voiceObj","audioBuffer","createBufferSource","Voice_prepareBuffer","Voice_changeDestination","enabled","dest","Bus_enable","Voice_loop","Voice_pause","termBusPool","destroyStreamPlayersPool","sourceObj","revokeObjectURL"],"mappings":"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"}